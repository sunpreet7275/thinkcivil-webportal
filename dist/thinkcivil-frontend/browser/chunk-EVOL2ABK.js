import{a as X,b as Z}from"./chunk-L5XWPQG3.js";import{a as ut,b as at}from"./chunk-Y6XZ2CXE.js";import{a as U}from"./chunk-3GT6KHKF.js";import{b as H,c as W,d as J,e as K,h as Q}from"./chunk-2UDCYGGM.js";import{a as ot}from"./chunk-OQXYGOAF.js";import{a as G,b as z,c as L,d as Y,f as $,g as j,h as it,j as nt}from"./chunk-XXQAJVF2.js";import{a as M}from"./chunk-ZZCTLGZF.js";import"./chunk-JTTWDSGT.js";import"./chunk-7RWCIHFI.js";import{h as tt,i as et,k as rt}from"./chunk-TC5NRSHV.js";import{b as k,d as w,f as D,g as I,l as A,o as V,r as B,u as R,w as N,y as q}from"./chunk-32HIGO4K.js";import"./chunk-DPS2XDEH.js";import"./chunk-QF2K6SUP.js";import"./chunk-VR4E7QUQ.js";import{d as y,e as T}from"./chunk-OI25WLE4.js";import"./chunk-OQEWKVRI.js";import{$c as S,D as C,Fb as s,Ga as p,Ob as r,Pb as i,Qb as P,Ub as h,Vc as O,Wb as _,Xb as l,gb as u,gc as a,hc as x,ia as b,ic as F,jc as E,qa as f,ra as g,sb as v,yb as c}from"./chunk-66BASCB4.js";function mt(e,o){e&1&&(r(0,"mat-error"),a(1," Email is required / \u0908\u092E\u0947\u0932 \u0906\u0935\u0936\u094D\u092F\u0915 \u0939\u0948 "),i())}function dt(e,o){e&1&&(r(0,"mat-error"),a(1," Please enter a valid email / \u0915\u0943\u092A\u092F\u093E \u0935\u0948\u0927 \u0908\u092E\u0947\u0932 \u0926\u0930\u094D\u091C \u0915\u0930\u0947\u0902 "),i())}function lt(e,o){e&1&&P(0,"mat-spinner",13)}function pt(e,o){e&1&&(r(0,"span"),a(1,"Send OTP / OTP \u092D\u0947\u091C\u0947\u0902"),i())}function ct(e,o){if(e&1){let n=h();r(0,"div",3)(1,"h3"),a(2,"Enter Your Email / \u0905\u092A\u0928\u093E \u0908\u092E\u0947\u0932 \u0926\u0930\u094D\u091C \u0915\u0930\u0947\u0902"),i(),r(3,"p",4),a(4,"We'll send you an OTP to reset your password / \u0939\u092E \u0906\u092A\u0915\u094B \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0930\u0940\u0938\u0947\u091F \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093F\u090F OTP \u092D\u0947\u091C\u0947\u0902\u0917\u0947"),i(),r(5,"form",5),_("ngSubmit",function(){f(n);let t=l();return g(t.sendPasswordResetOTP())}),r(6,"mat-form-field",6)(7,"mat-label"),a(8,"Registered Email / \u092A\u0902\u091C\u0940\u0915\u0943\u0924 \u0908\u092E\u0947\u0932"),i(),P(9,"input",7),c(10,mt,2,0,"mat-error",8)(11,dt,2,0,"mat-error",8),i(),r(12,"button",9),c(13,lt,1,0,"mat-spinner",10)(14,pt,2,0,"span",8),i()(),r(15,"div",11)(16,"a",12),a(17,"Back to Login / \u0932\u0949\u0917\u093F\u0928 \u092A\u0930 \u0935\u093E\u092A\u0938 \u091C\u093E\u090F\u0902"),i()()()}if(e&2){let n,m,t=l();u(5),s("formGroup",t.emailForm),u(5),s("ngIf",(n=t.emailForm.get("email"))==null?null:n.hasError("required")),u(),s("ngIf",(m=t.emailForm.get("email"))==null?null:m.hasError("email")),u(),s("disabled",!t.emailForm.valid||t.sendingOTP()),u(),s("ngIf",t.sendingOTP()),u(),s("ngIf",!t.sendingOTP())}}function ft(e,o){if(e&1&&(r(0,"mat-hint"),a(1),i()),e&2){let n=l(2);u(),F(" OTP expires in ",n.formatRemainingTime()," ")}}function gt(e,o){e&1&&(r(0,"mat-error"),a(1," OTP is required / OTP \u0906\u0935\u0936\u094D\u092F\u0915 \u0939\u0948 "),i())}function _t(e,o){e&1&&(r(0,"mat-error"),a(1," 6-digit OTP required / 6-\u0905\u0902\u0915\u0940\u092F OTP \u0926\u0930\u094D\u091C \u0915\u0930\u0947\u0902 "),i())}function Pt(e,o){e&1&&P(0,"mat-spinner",13)}function wt(e,o){e&1&&(r(0,"span"),a(1,"Verify OTP / OTP \u0938\u0924\u094D\u092F\u093E\u092A\u093F\u0924 \u0915\u0930\u0947\u0902"),i())}function bt(e,o){if(e&1){let n=h();r(0,"div",3)(1,"h3"),a(2,"Verify OTP / OTP \u0938\u0924\u094D\u092F\u093E\u092A\u093F\u0924 \u0915\u0930\u0947\u0902"),i(),r(3,"p",4),a(4),i(),r(5,"form",5),_("ngSubmit",function(){f(n);let t=l();return g(t.verifyPasswordResetOTP())}),r(6,"mat-form-field",6)(7,"mat-label"),a(8,"OTP / \u0935\u0928-\u091F\u093E\u0907\u092E \u092A\u093E\u0938\u0935\u0930\u094D\u0921"),i(),P(9,"input",14),c(10,ft,2,1,"mat-hint",8)(11,gt,2,0,"mat-error",8)(12,_t,2,0,"mat-error",8),i(),r(13,"div",15)(14,"button",16),_("click",function(){f(n);let t=l();return g(t.resendOTP())}),a(15," Resend OTP "),i()(),r(16,"div",17)(17,"button",18),_("click",function(){f(n);let t=l();return g(t.goBack())}),a(18," Back / \u0935\u093E\u092A\u0938 "),i(),r(19,"button",19),c(20,Pt,1,0,"mat-spinner",10)(21,wt,2,0,"span",8),i()()()()}if(e&2){let n,m,t=l();u(4),E("Enter the 6-digit OTP sent to ",t.email()," / ",t.email()," \u092A\u0930 \u092D\u0947\u091C\u0947 \u0917\u090F 6-\u0905\u0902\u0915\u0940\u092F OTP \u0926\u0930\u094D\u091C \u0915\u0930\u0947\u0902"),u(),s("formGroup",t.otpForm),u(5),s("ngIf",t.otpSent()&&!t.otpVerified()),u(),s("ngIf",(n=t.otpForm.get("otp"))==null?null:n.hasError("required")),u(),s("ngIf",(m=t.otpForm.get("otp"))==null?null:m.hasError("pattern")),u(2),s("disabled",t.resendDisabled()||t.otpVerified()),u(5),s("disabled",!t.otpForm.valid||t.verifyingOTP()),u(),s("ngIf",t.verifyingOTP()),u(),s("ngIf",!t.verifyingOTP())}}function ht(e,o){e&1&&(r(0,"mat-error"),a(1," New password is required / \u0928\u092F\u093E \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0906\u0935\u0936\u094D\u092F\u0915 \u0939\u0948 "),i())}function xt(e,o){e&1&&(r(0,"mat-error"),a(1," Minimum 6 characters required / \u0915\u092E \u0938\u0947 \u0915\u092E 6 \u0905\u0915\u094D\u0937\u0930\u094B\u0902 \u0915\u093E \u0939\u094B\u0928\u093E \u091A\u093E\u0939\u093F\u090F "),i())}function Ct(e,o){e&1&&(r(0,"mat-error"),a(1," Please confirm your password / \u0915\u0943\u092A\u092F\u093E \u0905\u092A\u0928\u0947 \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0915\u0940 \u092A\u0941\u0937\u094D\u091F\u093F \u0915\u0930\u0947\u0902 "),i())}function vt(e,o){e&1&&(r(0,"mat-error",25),a(1," Passwords do not match / \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u092E\u0947\u0932 \u0928\u0939\u0940\u0902 \u0916\u093E\u0924\u0947 "),i())}function Ft(e,o){e&1&&P(0,"mat-spinner",13)}function Et(e,o){e&1&&(r(0,"span"),a(1,"Reset Password / \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0930\u0940\u0938\u0947\u091F \u0915\u0930\u0947\u0902"),i())}function Ot(e,o){if(e&1){let n=h();r(0,"div",3)(1,"h3"),a(2,"Set New Password / \u0928\u092F\u093E \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0938\u0947\u091F \u0915\u0930\u0947\u0902"),i(),r(3,"p",4),a(4,"Create a new password for your account / \u0905\u092A\u0928\u0947 \u0916\u093E\u0924\u0947 \u0915\u0947 \u0932\u093F\u090F \u090F\u0915 \u0928\u092F\u093E \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u092C\u0928\u093E\u090F\u0902"),i(),r(5,"form",5),_("ngSubmit",function(){f(n);let t=l();return g(t.resetPassword())}),r(6,"mat-form-field",6)(7,"mat-label"),a(8,"New Password / \u0928\u092F\u093E \u092A\u093E\u0938\u0935\u0930\u094D\u0921"),i(),P(9,"input",20),r(10,"button",21),_("click",function(){f(n);let t=l();return g(t.togglePasswordVisibility())}),r(11,"mat-icon"),a(12),i()(),c(13,ht,2,0,"mat-error",8)(14,xt,2,0,"mat-error",8),i(),r(15,"mat-form-field",6)(16,"mat-label"),a(17,"Confirm Password / \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0915\u0940 \u092A\u0941\u0937\u094D\u091F\u093F \u0915\u0930\u0947\u0902"),i(),P(18,"input",22),r(19,"button",21),_("click",function(){f(n);let t=l();return g(t.toggleConfirmPasswordVisibility())}),r(20,"mat-icon"),a(21),i()(),c(22,Ct,2,0,"mat-error",8),i(),c(23,vt,2,0,"mat-error",23),r(24,"div",17)(25,"button",18),_("click",function(){f(n);let t=l();return g(t.goBack())}),a(26," Back / \u0935\u093E\u092A\u0938 "),i(),r(27,"button",24),c(28,Ft,1,0,"mat-spinner",10)(29,Et,2,0,"span",8),i()()()()}if(e&2){let n,m,t,d=l();u(5),s("formGroup",d.resetForm),u(4),s("type",d.showPassword()?"text":"password"),u(3),x(d.showPassword()?"visibility_off":"visibility"),u(),s("ngIf",(n=d.resetForm.get("newPassword"))==null?null:n.hasError("required")),u(),s("ngIf",(m=d.resetForm.get("newPassword"))==null?null:m.hasError("minlength")),u(4),s("type",d.showConfirmPassword()?"text":"password"),u(3),x(d.showConfirmPassword()?"visibility_off":"visibility"),u(),s("ngIf",(t=d.resetForm.get("confirmPassword"))==null?null:t.hasError("required")),u(),s("ngIf",d.resetForm.hasError("passwordMismatch")),u(4),s("disabled",!d.resetForm.valid||d.resettingPassword()),u(),s("ngIf",d.resettingPassword()),u(),s("ngIf",!d.resettingPassword())}}var st=class e{fb=b(N);authService=b(M);router=b(y);snackBar=b(ot);timerSubscription;currentStep=p("email");emailForm;otpForm;resetForm;sendingOTP=p(!1);verifyingOTP=p(!1);resettingPassword=p(!1);otpSent=p(!1);otpVerified=p(!1);showPassword=p(!1);showConfirmPassword=p(!1);remainingTime=p(600);resendDisabled=p(!1);email=p("");constructor(){this.emailForm=this.fb.group({email:["",[w.required,w.email]]}),this.otpForm=this.fb.group({otp:["",[w.required,w.pattern(/^\d{6}$/)]]}),this.resetForm=this.fb.group({newPassword:["",[w.required,w.minLength(6)]],confirmPassword:["",[w.required]]},{validators:this.passwordMatchValidator})}passwordMatchValidator(o){let n=o.get("newPassword")?.value,m=o.get("confirmPassword")?.value;return n===m?null:{passwordMismatch:!0}}startTimer(){this.remainingTime.set(600),this.timerSubscription&&this.timerSubscription.unsubscribe(),this.timerSubscription=C(1e3).subscribe(()=>{this.remainingTime()>0?this.remainingTime.update(o=>o-1):(this.timerSubscription?.unsubscribe(),this.otpSent.set(!1),this.snackBar.open("OTP expired. Please request a new one.","Close",{duration:3e3}))})}ngOnDestroy(){this.timerSubscription&&this.timerSubscription.unsubscribe()}sendPasswordResetOTP(){if(this.emailForm.invalid){this.snackBar.open("Please enter a valid email","Close",{duration:3e3});return}this.sendingOTP.set(!0);let o=this.emailForm.get("email")?.value;this.email.set(o),this.authService.sendPasswordResetOTP(o).subscribe({next:n=>{this.sendingOTP.set(!1),this.otpSent.set(!0),this.currentStep.set("otp"),this.resendDisabled.set(!0),this.startTimer(),this.snackBar.open("OTP sent to your email!","Close",{duration:3e3}),setTimeout(()=>{this.resendDisabled.set(!1)},6e4)},error:n=>{this.sendingOTP.set(!1),this.snackBar.open(n.error?.message||"Failed to send OTP","Close",{duration:3e3})}})}verifyPasswordResetOTP(){if(this.otpForm.invalid){this.snackBar.open("Please enter a valid 6-digit OTP","Close",{duration:3e3});return}this.verifyingOTP.set(!0);let o=this.otpForm.get("otp")?.value;this.authService.verifyPasswordResetOTP(this.email(),o).subscribe({next:n=>{this.verifyingOTP.set(!1),this.otpVerified.set(!0),this.currentStep.set("reset"),this.timerSubscription?.unsubscribe(),this.snackBar.open("OTP verified successfully!","Close",{duration:3e3})},error:n=>{this.verifyingOTP.set(!1),this.snackBar.open(n.error?.message||"Invalid OTP","Close",{duration:3e3})}})}resetPassword(){if(this.resetForm.invalid){this.snackBar.open("Please fill all fields correctly","Close",{duration:3e3});return}this.resettingPassword.set(!0);let{newPassword:o,confirmPassword:n}=this.resetForm.value,m=this.otpForm.get("otp")?.value;this.authService.resetPassword(this.email(),m,o,n).subscribe({next:t=>{this.resettingPassword.set(!1),this.snackBar.open("Password reset successful! You can now login.","Close",{duration:5e3}),this.router.navigate(["/login"])},error:t=>{this.resettingPassword.set(!1),this.snackBar.open(t.error?.message||"Failed to reset password","Close",{duration:3e3})}})}resendOTP(){this.resendDisabled()||this.sendPasswordResetOTP()}formatRemainingTime(){let o=Math.floor(this.remainingTime()/60),n=Math.floor(this.remainingTime()%60);return`${o.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}togglePasswordVisibility(){this.showPassword.set(!this.showPassword())}toggleConfirmPasswordVisibility(){this.showConfirmPassword.set(!this.showConfirmPassword())}goBack(){this.currentStep()==="reset"?this.currentStep.set("otp"):this.currentStep()==="otp"&&this.currentStep.set("email")}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=v({type:e,selectors:[["app-forgot-password"]],decls:11,vars:3,consts:[[1,"forgot-password-container"],[1,"forgot-password-card"],["class","step-content",4,"ngIf"],[1,"step-content"],[1,"step-description"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","email","type","email","placeholder","Enter your registered email / \u0905\u092A\u0928\u093E \u092A\u0902\u091C\u0940\u0915\u0943\u0924 \u0908\u092E\u0947\u0932 \u0926\u0930\u094D\u091C \u0915\u0930\u0947\u0902"],[4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"full-width",3,"disabled"],["diameter","20",4,"ngIf"],[1,"back-to-login"],["routerLink","/login"],["diameter","20"],["matInput","","formControlName","otp","placeholder","Enter 6-digit OTP / 6-\u0905\u0902\u0915\u0940\u092F OTP \u0926\u0930\u094D\u091C \u0915\u0930\u0947\u0902","maxlength","6"],[1,"otp-actions"],["mat-button","","type","button",3,"click","disabled"],[1,"form-actions"],["mat-stroked-button","","type","button",1,"back-btn",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"verify-btn",3,"disabled"],["matInput","","formControlName","newPassword","placeholder","Enter new password / \u0928\u092F\u093E \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0926\u0930\u094D\u091C \u0915\u0930\u0947\u0902",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","formControlName","confirmPassword","placeholder","Confirm new password / \u0928\u090F \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0915\u0940 \u092A\u0941\u0937\u094D\u091F\u093F \u0915\u0930\u0947\u0902",3,"type"],["class","password-error",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"submit-btn",3,"disabled"],[1,"password-error"]],template:function(n,m){n&1&&(r(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),a(4,"ThinkCivil IAS / \u0925\u093F\u0902\u0915\u0938\u093F\u0935\u093F\u0932 \u0906\u0908\u090F\u090F\u0938"),i(),r(5,"mat-card-subtitle"),a(6,"Reset Your Password / \u0905\u092A\u0928\u093E \u092A\u093E\u0938\u0935\u0930\u094D\u0921 \u0930\u0940\u0938\u0947\u091F \u0915\u0930\u0947\u0902"),i()(),r(7,"mat-card-content"),c(8,ct,18,6,"div",2)(9,bt,22,10,"div",2)(10,Ot,30,12,"div",2),i()()()),n&2&&(u(8),s("ngIf",m.currentStep()==="email"),u(),s("ngIf",m.currentStep()==="otp"),u(),s("ngIf",m.currentStep()==="reset"))},dependencies:[S,O,q,A,k,D,I,R,V,B,T,j,G,L,$,Y,z,U,Q,H,J,W,K,Z,X,rt,et,tt,nt,it,at,ut],styles:[".forgot-password-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:20px;background:linear-gradient(135deg,#e0f7fa,#e3f2fd,#e8eaf6);font-family:Poppins,sans-serif}.forgot-password-card[_ngcontent-%COMP%]{width:100%;max-width:450px;padding:2.5rem;border-radius:20px;box-shadow:0 10px 30px #0000001a;background:#fff;text-align:center;transition:all .3s ease-in-out}.forgot-password-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 12px 40px #00000026}mat-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:2rem;padding:0}mat-card-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:600;color:#1565c0;margin-bottom:.5rem}mat-card-subtitle[_ngcontent-%COMP%]{color:#616161;font-size:1rem;margin-bottom:0}.step-content[_ngcontent-%COMP%]{padding:1rem 0}.step-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem;color:#2c3e50;margin-bottom:.5rem}.step-description[_ngcontent-%COMP%]{color:#7f8c8d;font-size:.95rem;margin-bottom:2rem;line-height:1.5}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1.2rem}.otp-actions[_ngcontent-%COMP%]{text-align:right;margin-bottom:1.5rem}.otp-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#1e88e5;font-size:.9rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1.5rem}.back-btn[_ngcontent-%COMP%]{flex:1;border-color:#b0bec5;color:#546e7a}.verify-btn[_ngcontent-%COMP%], .submit-btn[_ngcontent-%COMP%]{flex:2}button[mat-raised-button][_ngcontent-%COMP%]{width:100%;padding:.85rem;background:linear-gradient(90deg,#42a5f5,#1e88e5);color:#fff;font-weight:600;letter-spacing:.5px;border-radius:8px;transition:all .3s ease;font-size:1rem;text-transform:none}button[mat-raised-button][_ngcontent-%COMP%]:hover:not([disabled]){background:linear-gradient(90deg,#1e88e5,#1565c0);box-shadow:0 4px 10px #2196f366}button[mat-raised-button][_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}button[mat-stroked-button][_ngcontent-%COMP%]{border-radius:8px;padding:.85rem}.back-to-login[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1.2rem;border-top:1px solid #eee}.back-to-login[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#1e88e5;text-decoration:none;font-weight:500;transition:color .2s ease}.back-to-login[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline;color:#1565c0}.password-error[_ngcontent-%COMP%]{display:block;color:#dc2626;font-size:.85rem;margin-top:-.8rem;margin-bottom:1rem;text-align:left}  .mat-mdc-text-field-wrapper{border-radius:8px!important}  .mat-mdc-form-field-subscript-wrapper{display:none}  .mat-mdc-form-field{--mat-form-field-container-height: 56px}  .mat-mdc-text-field-wrapper.mdc-text-field--outlined .mat-mdc-form-field-infix{padding-top:12px;padding-bottom:8px}  .mat-mdc-text-field-wrapper.mdc-text-field--outlined.mdc-text-field--focused .mdc-notched-outline__leading,   .mat-mdc-text-field-wrapper.mdc-text-field--outlined.mdc-text-field--focused .mdc-notched-outline__notch,   .mat-mdc-text-field-wrapper.mdc-text-field--outlined.mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#1e88e5!important}  .mat-mdc-form-field.mat-focused .mat-mdc-floating-label{color:#1e88e5!important}mat-spinner[_ngcontent-%COMP%]{display:inline-block;margin:0 auto}@media (max-width: 480px){.forgot-password-container[_ngcontent-%COMP%]{padding:15px}.forgot-password-card[_ngcontent-%COMP%]{padding:2rem 1.5rem}mat-card-title[_ngcontent-%COMP%]{font-size:1.5rem}mat-card-subtitle[_ngcontent-%COMP%]{font-size:.9rem}.step-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:.8rem}.back-btn[_ngcontent-%COMP%], .verify-btn[_ngcontent-%COMP%], .submit-btn[_ngcontent-%COMP%]{width:100%}}"]})};export{st as ForgotPasswordComponent};
