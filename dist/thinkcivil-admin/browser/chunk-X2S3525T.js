import{a as re}from"./chunk-L3QO6DVW.js";import{c as ee,d as te,e as ne,f as ie,g as ae}from"./chunk-4TA4R672.js";import{b as oe}from"./chunk-ANLVYVIZ.js";import{a as X,b as Z}from"./chunk-BFQVRRBQ.js";import{a as J,b as K}from"./chunk-XMRX5FRA.js";import{K as U,L as W,N as Y}from"./chunk-7XSJTIVU.js";import"./chunk-ZWY6WOSF.js";import{A as H,b as L,d as m,f as B,g as R,l as G,o as q,r as j,s as A,t as $,y as Q}from"./chunk-MUJPFQ6Z.js";import{$b as O,Db as g,Fb as y,Gb as w,Mb as i,Nb as n,Ob as C,Oc as k,Pc as D,Sb as v,Sc as V,Ub as f,Vb as p,Vc as z,_b as P,ac as E,ec as o,ed as N,fb as r,fc as h,gc as T,ic as F,kb as M,qc as x,ra as u,rb as S,rc as b,sa as _,tc as I,xb as d}from"./chunk-SZ6SDWKT.js";var se=["tagDialogTemplate"];function ge(t,a){if(t&1&&(i(0,"div",12),o(1),n()),t&2){let e=p();w(e.messageType),r(),T(" ",e.message," ")}}function ce(t,a){t&1&&(i(0,"div",13),C(1,"div",14),i(2,"p"),o(3,"Loading tags..."),n()())}function pe(t,a){if(t&1){let e=v();i(0,"div",15)(1,"mat-icon"),o(2,"sell"),n(),i(3,"p"),o(4,"No tags found. Create your first tag!"),n(),i(5,"button",16),f("click",function(){u(e);let s=p();return _(s.openCreateDialog())}),i(6,"mat-icon"),o(7,"add"),n(),o(8," Create First Tag "),n()()}}function de(t,a){if(t&1){let e=v();i(0,"tr")(1,"td",19)(2,"span",20),o(3),x(4,"titlecase"),n()(),i(5,"td",21)(6,"span",22),o(7),x(8,"titlecase"),n()(),i(9,"td",23)(10,"span",24),o(11),x(12,"titlecase"),n()(),i(13,"td",25)(14,"code"),o(15),n()(),i(16,"td",26)(17,"button",27),f("click",function(){let s=u(e).$implicit,c=p(2);return _(c.editTag(s))}),i(18,"mat-icon"),o(19,"edit"),n(),o(20," Edit "),n(),i(21,"button",28),f("click",function(){let s=u(e).$implicit,c=p(2);return _(c.deleteTag(s))}),i(22,"mat-icon"),o(23,"delete"),n(),o(24," Delete "),n()()()}if(t&2){let e=a.$implicit;r(3),h(b(4,4,e.category)),r(4),h(b(8,6,e.subCategory)),r(4),h(b(12,8,e.topic)),r(4),h(e.tag)}}function me(t,a){if(t&1&&(i(0,"div",17)(1,"table")(2,"thead")(3,"tr")(4,"th"),o(5,"Category"),n(),i(6,"th"),o(7,"Sub-Category"),n(),i(8,"th"),o(9,"Topic"),n(),i(10,"th"),o(11,"Tag"),n(),i(12,"th"),o(13,"Actions"),n()()(),i(14,"tbody"),d(15,de,25,10,"tr",18),n()()()),t&2){let e=p();r(15),g("ngForOf",e.tags)}}function ue(t,a){if(t&1&&(i(0,"option",51),o(1),x(2,"titlecase"),n()),t&2){let e=a.$implicit;g("value",e),r(),h(b(2,2,e))}}function _e(t,a){t&1&&(i(0,"span"),o(1,"Category is required"),n())}function fe(t,a){t&1&&(i(0,"span"),o(1,"Category must be at least 2 characters long"),n())}function xe(t,a){t&1&&(i(0,"span"),o(1,"Category cannot exceed 50 characters"),n())}function be(t,a){if(t&1&&(i(0,"div",52),d(1,_e,2,0,"span",50)(2,fe,2,0,"span",50)(3,xe,2,0,"span",50),n()),t&2){let e,l,s,c=p(2);r(),g("ngIf",(e=c.tagForm.get("category"))==null||e.errors==null?null:e.errors.required),r(),g("ngIf",(l=c.tagForm.get("category"))==null||l.errors==null?null:l.errors.minlength),r(),g("ngIf",(s=c.tagForm.get("category"))==null||s.errors==null?null:s.errors.maxlength)}}function he(t,a){t&1&&(i(0,"span"),o(1,"Sub-category is required"),n())}function Ce(t,a){t&1&&(i(0,"span"),o(1,"Sub-category must be at least 2 characters long"),n())}function ve(t,a){t&1&&(i(0,"span"),o(1,"Sub-category cannot exceed 50 characters"),n())}function Me(t,a){if(t&1&&(i(0,"div",52),d(1,he,2,0,"span",50)(2,Ce,2,0,"span",50)(3,ve,2,0,"span",50),n()),t&2){let e,l,s,c=p(2);r(),g("ngIf",(e=c.tagForm.get("subCategory"))==null||e.errors==null?null:e.errors.required),r(),g("ngIf",(l=c.tagForm.get("subCategory"))==null||l.errors==null?null:l.errors.minlength),r(),g("ngIf",(s=c.tagForm.get("subCategory"))==null||s.errors==null?null:s.errors.maxlength)}}function ye(t,a){t&1&&(i(0,"span"),o(1,"Topic is required"),n())}function Te(t,a){t&1&&(i(0,"span"),o(1,"Topic must be at least 2 characters long"),n())}function Se(t,a){t&1&&(i(0,"span"),o(1,"Topic cannot exceed 50 characters"),n())}function we(t,a){if(t&1&&(i(0,"div",52),d(1,ye,2,0,"span",50)(2,Te,2,0,"span",50)(3,Se,2,0,"span",50),n()),t&2){let e,l,s,c=p(2);r(),g("ngIf",(e=c.tagForm.get("topic"))==null||e.errors==null?null:e.errors.required),r(),g("ngIf",(l=c.tagForm.get("topic"))==null||l.errors==null?null:l.errors.minlength),r(),g("ngIf",(s=c.tagForm.get("topic"))==null||s.errors==null?null:s.errors.maxlength)}}function Pe(t,a){if(t&1&&(i(0,"div",35)(1,"label"),o(2,"Full Path Preview:"),n(),i(3,"div",53),o(4),x(5,"titlecase"),x(6,"titlecase"),x(7,"titlecase"),n()()),t&2){let e,l=p(2);r(4),F(" ",b(5,3,(e=l.tagForm.get("category"))==null?null:e.value)," / ",b(6,5,(e=l.tagForm.get("subCategory"))==null?null:e.value)," / ",b(7,7,(e=l.tagForm.get("topic"))==null?null:e.value)," ")}}function Oe(t,a){t&1&&C(0,"mat-spinner",54)}function Ee(t,a){if(t&1&&(i(0,"span"),o(1),n()),t&2){let e=p(2);r(),T("",e.editingTag?"Update":"Create"," Tag")}}function Fe(t,a){if(t&1){let e=v();i(0,"div",29)(1,"div",30)(2,"h2",31),o(3),n(),i(4,"button",32),f("click",function(){u(e);let s=p();return _(s.closeDialog())}),i(5,"mat-icon"),o(6,"close"),n()()(),i(7,"mat-dialog-content",33)(8,"form",34),f("ngSubmit",function(){u(e);let s=p();return _(s.onSubmit())}),i(9,"div",35)(10,"label",36),o(11,"Category *"),n(),C(12,"input",37),i(13,"datalist",38),d(14,ue,3,4,"option",39),n(),d(15,be,4,3,"div",40),n(),i(16,"div",35)(17,"label",41),o(18,"Sub-Category *"),n(),C(19,"input",42),d(20,Me,4,3,"div",40),n(),i(21,"div",35)(22,"label",43),o(23,"Topic *"),n(),C(24,"input",44),d(25,we,4,3,"div",40),n(),d(26,Pe,8,9,"div",45),n()(),i(27,"mat-dialog-actions",46)(28,"button",47),f("click",function(){u(e);let s=p();return _(s.closeDialog())}),o(29," Cancel "),n(),i(30,"button",48),f("click",function(){u(e);let s=p();return _(s.onSubmit())}),d(31,Oe,1,0,"mat-spinner",49)(32,Ee,2,1,"span",50),n()()()}if(t&2){let e=p();r(3),h(e.editingTag?"Edit Tag":"Create New Tag"),r(5),g("formGroup",e.tagForm),r(4),y("error",e.isFieldInvalid("category")),r(2),g("ngForOf",e.categorySuggestions),r(),g("ngIf",e.isFieldInvalid("category")),r(4),y("error",e.isFieldInvalid("subCategory")),r(),g("ngIf",e.isFieldInvalid("subCategory")),r(4),y("error",e.isFieldInvalid("topic")),r(),g("ngIf",e.isFieldInvalid("topic")),r(),g("ngIf",e.tagForm.valid),r(2),g("disabled",e.isSubmitting),r(2),g("disabled",e.isSubmitting||e.tagForm.invalid),r(),g("ngIf",e.isSubmitting),r(),g("ngIf",!e.isSubmitting)}}var le=class t{constructor(a,e,l){this.fb=a;this.tagService=e;this.dialog=l;this.tagForm=this.createForm()}tagDialogTemplate;tagForm;tags=[];isLoading=!1;isSubmitting=!1;message="";messageType="success";editingTag=null;categorySuggestions=[];dialogRef=null;ngOnInit(){this.loadTags(),this.loadCategories()}createForm(){return this.fb.group({category:["",[m.required,m.minLength(2),m.maxLength(50)]],subCategory:["",[m.required,m.minLength(2),m.maxLength(50)]],topic:["",[m.required,m.minLength(2),m.maxLength(50)]]})}loadTags(){this.isLoading=!0,this.tagService.getTags().subscribe({next:a=>{this.tags=a,this.isLoading=!1},error:a=>{console.error("Error loading tags:",a),this.showMessage("Error loading tags","error"),this.isLoading=!1}})}loadCategories(){this.tagService.getCategories().subscribe({next:a=>{this.categorySuggestions=a},error:a=>{console.error("Error loading categories:",a)}})}openCreateDialog(){this.editingTag=null,this.tagForm.reset(),this.openDialog()}editTag(a){this.editingTag=a,this.tagForm.patchValue({category:a.category,subCategory:a.subCategory,topic:a.topic}),this.openDialog()}openDialog(){this.dialogRef=this.dialog.open(this.tagDialogTemplate,{width:"500px",maxWidth:"90vw",panelClass:"tag-dialog-panel",autoFocus:!1}),this.dialogRef.afterClosed().subscribe(()=>{this.resetForm()})}closeDialog(){this.dialogRef&&this.dialogRef.close()}onSubmit(){if(this.tagForm.valid){this.isSubmitting=!0;let a=this.tagForm.value;this.editingTag?this.tagService.updateTag(this.editingTag._id,a).subscribe({next:e=>{this.showMessage("Tag updated successfully!","success"),this.loadTags(),this.closeDialog(),this.isSubmitting=!1},error:e=>{console.error("Error updating tag:",e),this.showMessage(e.error?.message||"Error updating tag","error"),this.isSubmitting=!1}}):this.tagService.createTag(a).subscribe({next:e=>{this.showMessage("Tag created successfully!","success"),this.loadTags(),this.loadCategories(),this.closeDialog(),this.isSubmitting=!1},error:e=>{console.error("Error creating tag:",e),this.showMessage(e.error?.message||"Error creating tag","error"),this.isSubmitting=!1}})}else this.markFormGroupTouched(),this.showMessage("Please fill all fields correctly","error")}deleteTag(a){confirm(`Are you sure you want to delete the tag "${a.tag}"?`)&&this.tagService.deleteTag(a._id).subscribe({next:e=>{this.showMessage("Tag deleted successfully!","success"),this.loadTags(),this.loadCategories()},error:e=>{console.error("Error deleting tag:",e),this.showMessage("Error deleting tag","error")}})}resetForm(){this.tagForm.reset(),this.editingTag=null}markFormGroupTouched(){Object.keys(this.tagForm.controls).forEach(a=>{this.tagForm.get(a)?.markAsTouched()})}showMessage(a,e){this.message=a,this.messageType=e,setTimeout(()=>{this.message=""},5e3)}isFieldInvalid(a){let e=this.tagForm.get(a);return!!(e&&e.invalid&&e.touched)}static \u0275fac=function(e){return new(e||t)(M(Q),M(re),M(ee))};static \u0275cmp=S({type:t,selectors:[["app-tag-master"]],viewQuery:function(e,l){if(e&1&&P(se,5),e&2){let s;O(s=E())&&(l.tagDialogTemplate=s.first)}},decls:25,vars:5,consts:[["tagDialogTemplate",""],[1,"tag-management"],[1,"header"],["class","message",3,"class",4,"ngIf"],["class","loading",4,"ngIf"],[1,"tags-container"],[1,"listing-section"],[1,"section-header"],[1,"tag-count"],[1,"btn","btn-primary",3,"click"],["class","empty-state",4,"ngIf"],["class","tags-table",4,"ngIf"],[1,"message"],[1,"loading"],[1,"spinner"],[1,"empty-state"],["mat-raised-button","","color","primary",3,"click"],[1,"tags-table"],[4,"ngFor","ngForOf"],[1,"category-name"],[1,"category-badge"],[1,"sub-category-name"],[1,"sub-category-badge"],[1,"topic-name"],[1,"topic-badge"],[1,"full-path"],[1,"actions"],["title","Edit tag",1,"btn-edit",3,"click"],["title","Delete tag",1,"btn-delete",3,"click"],[1,"tag-dialog"],[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","",1,"close-button",3,"click"],[1,"dialog-content"],[1,"tag-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","category"],["type","text","id","category","formControlName","category","placeholder","Enter category (e.g., History, Science)","list","categorySuggestions",1,"form-control"],["id","categorySuggestions"],[3,"value",4,"ngFor","ngForOf"],["class","error-message",4,"ngIf"],["for","subCategory"],["type","text","id","subCategory","formControlName","subCategory","placeholder","Enter sub-category (e.g., Ancient History, Physics)",1,"form-control"],["for","topic"],["type","text","id","topic","formControlName","topic","placeholder","Enter topic (e.g., Gupta Empire, Newton's Laws)",1,"form-control"],["class","form-group",4,"ngIf"],["align","end",1,"dialog-actions"],["mat-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],["diameter","20",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"error-message"],[1,"path-preview"],["diameter","20"]],template:function(e,l){if(e&1){let s=v();i(0,"div",1)(1,"div",2)(2,"h2"),o(3,"Tag Management"),n(),i(4,"p"),o(5,"Create, edit, and manage tags with category hierarchy"),n()(),d(6,ge,2,3,"div",3)(7,ce,4,0,"div",4),i(8,"div",5)(9,"div",6)(10,"div",7)(11,"div")(12,"h3"),o(13,"All Tags"),n(),i(14,"span",8),o(15),n()(),i(16,"div")(17,"button",9),f("click",function(){return u(s),_(l.openCreateDialog())}),i(18,"mat-icon"),o(19,"add"),n(),o(20," Create New Tag "),n()()(),d(21,pe,9,0,"div",10)(22,me,16,1,"div",11),n()()(),d(23,Fe,33,17,"ng-template",null,0,I)}e&2&&(r(6),g("ngIf",l.message),r(),g("ngIf",l.isLoading),r(8),T("",l.tags.length," tag(s)"),r(6),g("ngIf",l.tags.length===0&&!l.isLoading),r(),g("ngIf",l.tags.length>0))},dependencies:[z,k,D,V,H,G,A,$,L,B,R,q,j,N,ae,te,ie,ne,Y,W,U,Z,X,K,J,oe],styles:[`.tag-management[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:25px;border-radius:10px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 10px;font-size:2rem}.header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;opacity:.9;font-size:1rem}.message[_ngcontent-%COMP%]{padding:12px 15px;border-radius:6px;margin-bottom:20px;font-weight:500}.message.success[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46;border:1px solid #a7f3d0}.message.error[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;border:1px solid #fecaca}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#6b7280}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f4f6;border-left:3px solid #667eea;border-radius:50%;width:30px;height:30px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 15px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.tags-container[_ngcontent-%COMP%]{margin-top:30px}.listing-section[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:10px;box-shadow:0 2px 10px #0000001a;border:1px solid #e5e7eb}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:15px;border-bottom:2px solid #e5e7eb}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 5px;color:#374151;font-size:1.3rem}.tag-count[_ngcontent-%COMP%]{background:#667eea;color:#fff;padding:4px 12px;border-radius:15px;font-size:12px;font-weight:600}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#6b7280}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:15px;opacity:.5}.tags-table[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}thead[_ngcontent-%COMP%]{background:#f8fafc}th[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;font-weight:600;color:#374151;border-bottom:2px solid #e5e7eb}td[_ngcontent-%COMP%]{padding:12px 15px;border-bottom:1px solid #e5e7eb}.category-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:6px 12px;border-radius:12px;font-size:13px;font-weight:500;white-space:nowrap}.sub-category-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff;padding:6px 12px;border-radius:12px;font-size:13px;font-weight:500;white-space:nowrap}.topic-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#047857);color:#fff;padding:6px 12px;border-radius:12px;font-size:13px;font-weight:500;white-space:nowrap}.full-path[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569;padding:6px 10px;border-radius:6px;font-size:13px;font-family:Courier New,monospace}.actions[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-edit[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:all .3s ease;font-weight:500;display:flex;align-items:center;gap:4px;white-space:nowrap}.btn-edit[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.btn-edit[_ngcontent-%COMP%]:hover{background:#2563eb}.btn-delete[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.btn-delete[_ngcontent-%COMP%]:hover{background:#dc2626}.btn[_ngcontent-%COMP%]{padding:12px 24px;border:none;border-radius:6px;font-weight:600;cursor:pointer;transition:all .3s ease;font-size:14px;display:flex;align-items:center;gap:8px}.btn-primary[_ngcontent-%COMP%]{background:#667eea;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6fd8;transform:translateY(-1px)}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.tag-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:90vh}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;background:#fff;border-bottom:1px solid #e5e7eb;position:sticky;top:0;z-index:10}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#1f2937;font-weight:600;font-size:1.4rem}.close-button[_ngcontent-%COMP%]{color:#6b7280}.dialog-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:24px}.tag-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:8px;color:#374151;font-size:.9rem}.form-control[_ngcontent-%COMP%]{padding:12px 15px;border:2px solid #e5e7eb;border-radius:6px;font-size:14px;transition:all .3s ease;width:100%}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-control.error[_ngcontent-%COMP%]{border-color:#dc2626}.error-message[_ngcontent-%COMP%]{color:#dc2626;font-size:12px;margin-top:5px}.path-preview[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e5e7eb;border-radius:6px;padding:12px 15px;font-family:Courier New,monospace;font-size:14px;color:#374151}.dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;background:#fff;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end;gap:12px}input[list][_ngcontent-%COMP%]{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236b7280' viewBox='0 0 16 16'%3E%3Cpath d='M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 10px center;background-size:16px}@media (max-width: 768px){.tag-management[_ngcontent-%COMP%]{padding:15px}.listing-section[_ngcontent-%COMP%]{padding:20px}.actions[_ngcontent-%COMP%]{flex-direction:column;gap:5px}.btn-edit[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{padding:8px 12px;font-size:11px;justify-content:center}.section-header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:stretch}.full-path[_ngcontent-%COMP%]{display:none}}`]})};export{le as TagMasterComponent};
